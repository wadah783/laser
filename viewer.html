<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ø§Ø­Ø«ÙŠÙ†</title>
  <style>
    body {
      font-family: Arial;
      direction: rtl;
      margin: 20px;
    }

    .menu-bar {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
    }

    .menu {
      position: relative;
    }

    .menu button {
      padding: 10px 15px;
      background-color: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
      border-radius: 4px;
    }

    .menu button:hover {
      background-color: #45a049;
    }

    .dropdown {
      display: none;
      position: absolute;
      background-color: #f9f9f9;
      border: 1px solid #ccc;
      min-width: 250px;
      padding: 10px;
      z-index: 1;
      top: 100%;
      right: 0;
    }

    .dropdown input,
    .dropdown select,
    .dropdown button {
      margin-top: 5px;
      width: 100%;
    }

    #customColumnSelect {
      height: 120px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 30px;
    }

    th, td {
      border: 1px solid #aaa;
      padding: 8px;
      text-align: center;
    }

    #overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: rgba(0, 0, 0, 0.6);
      display: none;
    }

    #popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 20px;
      border-radius: 8px;
      z-index: 9999;
      display: none;
      width: 300px;
      text-align: center;
    }

    #popup button {
      margin-top: 10px;
      padding: 5px 10px;
    }
  </style>
</head>
<body>

  <div class="menu-bar">
    <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¨Ø­Ø« -->
    <div class="menu">
      <button onclick="toggleMenu('searchMenu')">ğŸ” Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…</button>
      <div id="searchMenu" class="dropdown">
        <label>Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø­Ø«:</label>
        <input type="text" id="searchName" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù…">
        <button onclick="searchAndShowData()">ğŸ“„ Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
      </div>
    </div>

    <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø© -->
    <div class="menu">
      <button onclick="toggleMenu('customColumnMenu')">ğŸ“‹ Ø£Ø¹Ù…Ø¯Ø© Ù…Ø®ØªØ§Ø±Ø©</button>
      <div id="customColumnMenu" class="dropdown">
        <label>Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø­Ø«:</label>
        <input type="text" id="customSearchName" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù…">
        <label style="margin-top:10px;">Ø§Ø®ØªØ± Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©:</label>
        <select id="customColumnSelect" multiple></select>
        <button onclick="searchSelectedColumns()">âœ… Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
      </div>
    </div>
  </div>

  <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
  <table id="csvTable">
    <thead>
      <tr>
        <th>Ø§Ù„Ø§Ø³Ù…</th>
        <th>Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©</th>
        <th>Ø§Ù„Ù…Ø¤ØªÙ…Ø±</th>
        <th>Ø§Ù„Ù…Ù†ØµØ¨</th>
        <th>Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Ø£Ø­Ù…Ø¯ Ø¹Ù„ÙŠ</td><td>Ø¯ÙƒØªÙˆØ±Ø§Ù‡</td><td>Ù…Ø¤ØªÙ…Ø± Ø¹Ù„Ù…ÙŠ</td><td>Ø£Ø³ØªØ§Ø°</td><td>Ø¬Ø§Ù…Ø¹Ø© Ø¨ØºØ¯Ø§Ø¯</td>
      </tr>
      <tr>
        <td>Ø³Ø§Ø±Ø© Ø­Ø³Ù†</td><td>Ù…Ø§Ø¬Ø³ØªÙŠØ±</td><td>Ù†Ø¯ÙˆØ© Ø·Ø¨ÙŠØ©</td><td>Ù…Ø­Ø§Ø¶Ø±</td><td>Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ù…ÙˆØµÙ„</td>
      </tr>
    </tbody>
  </table>

  <!-- Ù†Ø§ÙØ°Ø© Ù…Ù†Ø¨Ø«Ù‚Ø© -->
  <div id="overlay"></div>
  <div id="popup">
    <p id="popupMessage"></p>
    <button onclick="closePopup()">Ø¥ØºÙ„Ø§Ù‚</button>
    <button onclick="downloadPopupContent()">ØªØ­Ù…ÙŠÙ„</button>
  </div>

  <script>
    function toggleMenu(id) {
      document.querySelectorAll(".dropdown").forEach(menu => {
        if (menu.id !== id) menu.style.display = "none";
      });
      const menu = document.getElementById(id);
      menu.style.display = menu.style.display === "block" ? "none" : "block";
    }

    function searchAndShowData() {
      const name = document.getElementById("searchName").value.trim();
      const rows = document.querySelectorAll("#csvTable tbody tr");
      let result = "", html = "";

      for (const row of rows) {
        const cells = row.querySelectorAll("td");
        if (cells[0].textContent.trim() === name) {
          result = `Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ø§Ø­Ø«: ${name}\n\n`;
          html = `<b>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ø§Ø­Ø«: ${name}</b><br><br>`;
          document.querySelectorAll("#csvTable thead th").forEach((th, i) => {
            const label = th.textContent;
            const value = cells[i]?.textContent || "";
            result += `${label}: ${value}\n`;
            html += `<b>${label}:</b> ${value}<br>`;
          });
          sessionStorage.setItem("popupText", result);
          showPopup(html);
          return;
        }
      }
      showPopup("âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³Ù….");
    }

    function searchSelectedColumns() {
      const name = document.getElementById("customSearchName").value.trim();
      const selectedOptions = [...document.getElementById("customColumnSelect").selectedOptions];
      const selectedColumns = selectedOptions.map(o => o.value);

      const headers = [...document.querySelectorAll("#csvTable thead th")].map(th => th.textContent);
      const rows = document.querySelectorAll("#csvTable tbody tr");
      const row = [...rows].find(r => r.querySelector("td")?.textContent.trim() === name);

      if (!row) {
        showPopup("âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³Ù….");
        return;
      }

      const cells = row.querySelectorAll("td");
      let result = `Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ø§Ø­Ø«: ${name}\n\n`;
      let html = `<b>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ø§Ø­Ø«: ${name}</b><br><br>`;

      selectedColumns.forEach(col => {
        const idx = headers.indexOf(col);
        if (idx !== -1) {
          const value = cells[idx]?.textContent || "";
          result += `${col}: ${value}\n`;
          html += `<b>${col}:</b> ${value}<br>`;
        }
      });

      sessionStorage.setItem("popupText", result);
      showPopup(html);
    }

    function showPopup(message) {
      document.getElementById("popupMessage").innerHTML = message;
      document.getElementById("overlay").style.display = "block";
      document.getElementById("popup").style.display = "block";
    }

    function closePopup() {
      document.getElementById("overlay").style.display = "none";
      document.getElementById("popup").style.display = "none";
    }

    function downloadPopupContent() {
      const name = document.getElementById("customSearchName").value.trim() || "Ø¨ÙŠØ§Ù†Ø§Øª";
      const content = sessionStorage.getItem("popupText");
      const blob = new Blob([content], { type: "text/plain;charset=utf-8" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = `${name}.txt`;
      link.click();
    }

    window.addEventListener("DOMContentLoaded", () => {
      const select = document.getElementById("customColumnSelect");
      const headers = document.querySelectorAll("#csvTable thead th");
      headers.forEach(th => {
        const opt = document.createElement("option");
        opt.value = th.textContent;
        opt.textContent = th.textContent;
        select.appendChild(opt);
      });
    });
  </script>
</body>
</html>
