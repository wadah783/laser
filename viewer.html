<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>عرض معلومات الباحث</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      direction: rtl;
      text-align: right;
      background-color: #f0f4f8;
      padding: 30px;
    }

    h1 {
      color: #333;
    }

    label {
      font-weight: bold;
    }

    select, input {
      padding: 10px;
      margin: 10px 0;
      font-size: 16px;
      border-radius: 8px;
      border: 1px solid #ccc;
      width: 300px;
    }

    button {
      background-color: #007bff;
      color: white;
      border: none;
      padding: 10px 20px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.3s;
      margin: 5px;
    }

    button:hover {
      background-color: #0056b3;
    }

    #result {
      margin-top: 20px;
      padding: 15px;
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>

  <h1>معلومات الباحث</h1>

  <label for="researcher">اختر اسم الباحث:</label><br>
  <select id="researcher">
    <option value="">-- اختر باحث --</option>
    <option value="أحمد محمد">أحمد محمد</option>
    <option value="سارة خالد">سارة خالد</option>
    <option value="ليلى حسين">ليلى حسين</option>
  </select><br>

  <label for="column">اختر العمود:</label><br>
  <select id="column">
    <option value="">-- اختر نوع المعلومة --</option>
    <option value="النشاط العام">النشاط العام</option>
    <option value="الجوائز">الجوائز</option>
    <option value="التعاون">التعاون</option>
  </select><br>

  <label for="manualName">أدخل اسم الباحث يدويًا (اختياري):</label><br>
  <input type="text" id="manualName" placeholder="اكتب الاسم هنا"><br>

  <button onclick="showData()">عرض البيانات</button>
  <button onclick="downloadCSV()">
    <i class="fas fa-file-csv"></i> تحميل كل الباحثين
  </button>
  <button onclick="downloadSelectedResearcher()">
    <i class="fas fa-user"></i> تحميل بيانات الباحث المحدد
  </button>

  <div id="result"></div>

  <script>
    const data = {
      "أحمد محمد": {
        "النشاط العام": "شارك في 5 ورش",
        "الجوائز": "جائزة الباحث المتميز",
        "التعاون": "وزارة التعليم"
      },
      "سارة خالد": {
        "النشاط العام": "3 ورش",
        "الجوائز": "لا يوجد",
        "التعاون": "داخلي فقط"
      },
      "ليلى حسين": {
        "النشاط العام": "8 ورش ومؤتمرات",
        "الجوائز": "أفضل محاضرة",
        "التعاون": "دولي"
      }
    };

    function getSelectedName() {
      const manualName = document.getElementById("manualName").value.trim();
      return manualName !== "" ? manualName : document.getElementById("researcher").value;
    }

    function showData() {
      const selectedName = getSelectedName();
      const column = document.getElementById("column").value;
      const resultDiv = document.getElementById("result");

      if (!selectedName || !column) {
        resultDiv.innerHTML = "<strong>يرجى اختيار اسم الباحث والعمود المطلوب.</strong>";
        return;
      }

      if (!data[selectedName]) {
        resultDiv.innerHTML = `<strong>لا توجد بيانات لهذا الباحث (${selectedName}).</strong>`;
        return;
      }

      const value = data[selectedName][column];
      resultDiv.innerHTML = value
        ? `<strong>${column}:</strong> ${value}`
        : `<strong>${column}:</strong> لا توجد معلومات متاحة.`;
    }

    function downloadCSV() {
      let csvContent = "اسم الباحث,النشاط العام,الجوائز,التعاون\n";
      for (const name in data) {
        const row = [
          name,
          data[name]["النشاط العام"] || "",
          data[name]["الجوائز"] || "",
          data[name]["التعاون"] || ""
        ];
        csvContent += row.join(",") + "\n";
      }

      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "researchers.csv";
      link.click();
    }

    function downloadSelectedResearcher() {
      const selectedName = getSelectedName();

      if (!selectedName) {
        alert("يرجى اختيار أو إدخال اسم الباحث.");
        return;
      }

      const researcher = data[selectedName];
      if (!researcher) {
        alert("لا توجد بيانات لهذا الباحث.");
        return;
      }

      let csv = "اسم الباحث,النشاط العام,الجوائز,التعاون\n";
      csv += [
        selectedName,
        researcher["النشاط العام"] || "",
        researcher["الجوائز"] || "",
        researcher["التعاون"] || ""
      ].join(",") + "\n";

      const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = selectedName.replace(/ /g, "_") + ".csv";
      link.click();
    }
  </script>

</body>
</html>
